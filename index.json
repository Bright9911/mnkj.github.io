[{"categories":null,"content":" 导⼊pyspark.sql，创建spark session from pyspark import SparkConf from pyspark.sql import SparkSession import pyspark.sql.functions as f from pyspark.sql.functions import array_contains spark = SparkSession.builder.config(conf=SparkConf()).getOrCreate() 读取 yelp_academic_dataset_business.json ⽂件，创建DataFrame chushi = spark.read.json('file:///usr/local/src/yelp_academic_dataset_business.json') 分割数据集中 categories ，剔除数据集中缺少城市信息的数据 import pyspark.sql.functions as f chushitype = f.split(chushi[\"categories\"],',') fenge = chushi.withColumn(\"categories\",chushitype) chuli = fenge.dropna(subset=['city']) 显示数据集数据50条 chuli.show(50) 找出 Las Vegas(城市) 中所有 Burgers（汉堡店，类型） （20分），将结果按照星级降序排序，显示前50条 结果 cityLs = chuli.filter(chuli[\"city\"] == \"Las Vegas\") hb = cityLs.filter(array_contains(cityLs[\"categories\"],\"Burgers\")) jieg = hb.orderBy(-hb[\"stars\"]).show(50) 找出所有全美商业种类总数（10分），排序输出数量前⼗的商业种类（10分） quchu = chuli.filter(chuli[\"latitude\"]\u003e25).filter(chuli[\"latitude\"]\u003c49).filter(chuli[\"longitude\"]\u003c-70).filter(chuli[\"longitude\"]\u003e-130) quchu.select(quchu[\"categories\"]).distinct().count() lps = chushi.select(chushi[\"categories\"]).rdd.map(lambda x:(x,1)).reduceByKey(lambda x,y:x+y).toDF() lps.orderBy(-lps[\"_2\"]).show(10) ","date":"2022-06-14","objectID":"/spark/:0:0","tags":null,"title":"Spark","uri":"/spark/"},{"categories":null,"content":"keras-image-recognition keras 图像识别 ","date":"2022-06-14","objectID":"/first_post/:0:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"python版本 Python 3.4.5 ","date":"2022-06-14","objectID":"/first_post/:1:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"keras 版本 2.2.2 ","date":"2022-06-14","objectID":"/first_post/:2:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"tensoflow 版本 1.9.0 ","date":"2022-06-14","objectID":"/first_post/:3:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"os linux ","date":"2022-06-14","objectID":"/first_post/:4:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"训练/测试数据下载 链接：https://pan.baidu.com/s/1f1N01Qv5N6UouiOJS4ZCDg 提取码：ycks 链接：https://pan.baidu.com/s/1BSPDaqoQv_7kQifA9rbzMA 提取码：k7ej 下载完成后需要放到downloads 目录下面解压 ","date":"2022-06-14","objectID":"/first_post/:5:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"使用keras + tensorflow + cpu 进行图像识别 识别的类型有三种：猫，狗，马 需要安装依赖包 pip install -r requirements.txt 模型的可视化需要安装graphviz sudo apt-get install graphviz 或者 sudo yum install graphviz ","date":"2022-06-14","objectID":"/first_post/:6:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"运行项目 cd spiders/recognition/train python train.py ","date":"2022-06-14","objectID":"/first_post/:7:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"识别图像 cd spiders/prediction python prediction.py -i ./data/20181128094323.jpg -m ../classify.model ","date":"2022-06-14","objectID":"/first_post/:8:0","tags":null,"title":"First_post","uri":"/first_post/"},{"categories":null,"content":"更多介绍 https://blog.csdn.net/lucky404/article/details/84581885 ","date":"2022-06-14","objectID":"/first_post/:9:0","tags":null,"title":"First_post","uri":"/first_post/"}]